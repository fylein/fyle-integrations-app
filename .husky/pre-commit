#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Format only staged files with Prettier
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM --z | grep -E '\.(ts|js|html|scss|css|json)$' | grep '^src/' || true)

if [ -n "$STAGED_FILES" ]; then
  echo "$STAGED_FILES" | xargs -0 npx prettier --write
  echo "$STAGED_FILES" | xargs -0 git add
fi

# Lint and fix code
ng lint --fix
