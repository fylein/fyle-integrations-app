<div *ngIf="isLoading" class="tw-flex tw-justify-center tw-items-center tw-h-screen">
    <app-loader></app-loader>
</div>
<div *ngIf="!isLoading" class="tw-py-16-px tw-px-120-px">
        <div class="tw-flex tw-justify-between">
            <div class="tw-flex">
                <div class="tw-rounded-10-px tw-bg-white tw-border-1-px tw-border-separator tw-pt-16-px tw-pr-56-px tw-pb-10-px tw-pl-16-px tw-h-84-px">
                    <div class="tw-w-34-px tw-h-6-px tw-rounded-12-px tw-bg-bg-brand-muted">
                    </div>
                    <div class="tw-pt-8-px tw-text-text-muted tw-text-12-px">
                        <p>Total Employees</p>
                    </div>
                    <div class="tw-text-20-px tw-text-500 tw-text-slightly-normal-text-color">
                        <p>{{mappingStats.all_attributes_count}}</p>
                    </div>
                </div>
                <span class="tw-pl-16-px"></span>
                <div class="tw-rounded-10-px tw-bg-white tw-border-1-px tw-border-separator tw-pt-16-px tw-pr-56-px tw-pb-10-px tw-pl-16-px tw-h-84-px">
                    <div class="tw-w-34-px tw-h-6-px tw-rounded-12-px tw-bg-bg-brand-muted">
                    </div>
                    <div class="tw-pt-8-px tw-text-text-muted tw-text-12-px">
                        <p>Unmapped Employees</p>
                    </div>
                    <div class="tw-text-20-px tw-text-500 tw-text-slightly-normal-text-color">
                        <p>{{mappingStats.unmapped_attributes_count}}</p>
                    </div>
                </div>
            </div>
                <div *ngIf="autoMapEmployee" class="tw-mt-24-px">
                  <button type="button" class="tw-text-white tw-text-500 tw-px-24-px tw-py-12-px tw-bg-mandatory-field-color tw-rounded-4-px" (click)="triggerAutoMapEmployees()">
                    <p class="tw-text-14-px tw-font-400 tw-pl-5px">Auto Map Employees</p>
                  </button>
                </div>
        </div>

    <div class="tw-shadow-app-card tw-rounded-8-px tw-bg-white tw-border-1-px tw-border-separator tw-mt-16-px">
        <div class="tw-p-24-px tw-border-b-separator">
            <app-mapping-filter [appName]="AppName.INTACCT" [selectedAlphabeticalFilter]="alphabetFilter" [mappingFilter]="selectedMappingFilter" (mappingFilterChangeEvent)="mappingStateFilter($event)" (mappingSearchingEvent)="mappingSearchFilter($event)" (mappingFilterUpdateHandler)="mappingFilterUpdate($event)" [isAlphabetFilterHidden]="false"></app-mapping-filter>
        </div>
        <div *ngIf="filteredMappingCount" >
            <p-table [value]="filteredMappings" [tableStyle]="{ 'min-width': '50rem'}">
                <ng-template pTemplate="header">
                    <tr>
                    <th class="!tw-pl-40-px">Employee in {{brandingConfig.brandName}}</th>
                    <th>{{getAttributesFilteredByConfig()[0] | titlecase}} in Sage Intacct</th>
                    <th>Status</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-mapping>
                    <tr>
                        <td>
                            <div class="tw-flex tw-items-center">
                                <app-svg-icon *ngIf="mapping.auto_mapped" [tooltipText]="'Auto-mapped'" [tooltipPosition]="'top'" [svgSource]="'flash-on'" [width]="'12px'" [height]="'12px'" [styleClasses]="'tw-mr-12-px tw-text-placeholder'"></app-svg-icon>
                                <span [ngClass]="{'tw-pl-24-px': !mapping.auto_mapped}">{{ mapping.value }}</span>
                            </div>
                        </td>
                        <td>
                            <p-dropdown appendTo="body" (onShow)="tableDropdownWidth()"
                            [ngModel]="getDropdownValue(mapping.employeemapping)" 
                            [options]="fyleEmployeeOptions" 
                            optionLabel="value" 
                            placeholder="Select an Option" 
                            (onChange)="save(mapping, $event); getDropdownValue(mapping.employeemapping)"
                            [filter]="true"
                            filterBy="value"
                            [emptyFilterMessage]="mapping.employeemapping.isOptionSearchInProgress ? 'Searching...' : 'No results found'"
                            [dropdownIcon]="mapping.employeemapping.isOptionSearchInProgress ? 'pi pi-spinner pi-spin' : 'pi pi-chevron-down ' + brandingConfig.brandId"
                            (onFilter)="searchOptions($event, mapping.employeemapping)">
                            </p-dropdown>
                        </td>
                        <td>
                            <p *ngIf="getDropdownValue(mapping.employeemapping)" class="mapped">MAPPED</p>
                            <p *ngIf="!getDropdownValue(mapping.employeemapping)" class="unmapped">UNMAPPED</p>
                        </td>
                    </tr>
                </ng-template>
                </p-table>
        </div>
        <div class="tw-p-24-px tw-border-t-separator" *ngIf="filteredMappingCount" >
            <app-paginator [totalCount]="totalCount" [pageType]="PaginatorPage.MAPPING" [page]="currentPage" [dropDownValue]="limit" (pageSizeChangeEvent)="pageSizeChanges($event)" (pageOffsetChangeEvent)="pageOffsetChanges($event)"></app-paginator>
        </div>
        <div *ngIf="!filteredMappingCount">
            <app-zero-state-with-illustration [mainText]="'No employees to show yet!'" [subText]="'Looks like your search term does not match any of Employee mappings'"></app-zero-state-with-illustration>
        </div>
    </div>
</div>
