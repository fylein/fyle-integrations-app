<p-dialog 
[(visible)]="displayConfirmDialog"
[closable]="false"
[closeOnEscape]="false"
[modal]="true"
[draggable]="false"
[resizable]="false"
[style]="{width: '400px'}"
styleClass="ai-onboarding-dialog confirm-dialog"
>
<ng-template pTemplate="header">
  <div class="dialog-header">
    <h2>AI Onboarding</h2>
    <!-- <span class="close-icon" (click)="closeConfirmDialog()">&#10005;</span> -->
  </div>
</ng-template>
<p>Do you want to use AI Onboarding?</p>
<ng-template pTemplate="footer">
  <button pButton (click)="onConfirmYes()" label="Yes, sure" class="p-button-rounded p-button-primary"></button>
  <button pButton (click)="onConfirmNo()" label="No" class="p-button-rounded p-button-secondary"></button>
</ng-template>
</p-dialog>

<!-- AI Onboarding Chat Dialog -->
<p-dialog 
[(visible)]="displayChatDialog"
[closable]="false"
[closeOnEscape]="false"
[showHeader]="false"
[modal]="true"
[draggable]="false"
[resizable]="false"
[style]="{width: '500px'}"
styleClass="ai-onboarding-dialog chat-dialog"
>
<div class="chat-container">
  <div class="chat-header">
    <h2>QBD AI Onboarding</h2>
    <span class="close-icon" (click)="closeChatDialog()">&#10005;</span>
  </div>
  
  <div class="chat-messages" #chatMessages>
    <div *ngFor="let message of messages" 
         [ngClass]="{'ai-message': message.sender === 'ai', 'user-message': message.sender === 'user'}"
         [@messageAnimation]>
      {{ message.content }}
    </div>
    <div *ngIf="isLoading" class="loading-indicator" [@messageAnimation]>
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
    </div>
  </div>
  
  <div class="chat-input" [ngClass]="{'first-response': isFirstResponse}">
    <form [formGroup]="chatForm" (ngSubmit)="sendMessage()">
      <textarea 
        pInputTextarea 
        formControlName="userInput" 
        [autoResize]="true"
        placeholder="Type your answer here..."
        (keydown.enter)="onEnterKey($event)"
      ></textarea>
      <button type="submit" pButton [disabled]="!chatForm.valid" *ngIf="showSendButton">Send</button>
    </form>
  </div>
</div>
</p-dialog>

<!-- New confirmation popup -->
<p-dialog 
[(visible)]="showCloseConfirmation"
[closable]="false"
[closeOnEscape]="false"
[modal]="true"
[draggable]="false"
[resizable]="false"
[style]="{width: '400px'}"
styleClass="ai-onboarding-dialog confirm-dialog"
>
<ng-template pTemplate="header">
  <div class="dialog-header">
    <h2>Confirm Action</h2>
    <span class="close-icon" (click)="confirmClose(false)">&#10005;</span>
  </div>
</ng-template>
<p>Are you sure you want to close and proceed with manual onboarding?</p>
<ng-template pTemplate="footer">
  <button pButton (click)="confirmClose(true)" label="Yes" class="p-button-rounded p-button-primary"></button>
  <button pButton (click)="confirmClose(false)" label="No" class="p-button-rounded p-button-secondary"></button>
</ng-template>
</p-dialog>

<!-- Redirect Progress Dialog -->
<p-dialog 
  [(visible)]="showRedirectProgress"
  [closable]="false"
  [closeOnEscape]="false"
  [showHeader]="false"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [style]="{width: '400px'}"
  styleClass="ai-onboarding-dialog redirect-dialog"
>
  <div class="redirect-content">
    <p>Redirecting to export settings...</p>
    <!-- <p-progressBar mode="indeterminate"></p-progressBar> -->
  </div>
</p-dialog>