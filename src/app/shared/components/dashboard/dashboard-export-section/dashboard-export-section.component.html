<div class="tw-py-32-px" [ngClass]="brandingStyle.common.mainComponentPadding">
  @if (!isImportInProgress) {
    <div class="tw-rounded-8-px tw-bg-white tw-border-1-px tw-border-border-tertiary tw-z-1 tw-relative" [ngClass]="brandingStyle.common.mainComponentShadow">
      <div class="tw-p-24-px">
        <div class="tw-flex tw-items-center tw-justify-between">
          @if (brandingFeatureConfig.featureFlags.displayAppLogoInDashboard) {
            <img src="{{logoPath}}" width="logoWidth" class="tw-mr-24-px tw-h-44-px"/>
          }
          <div class="tw-w-4/5">
            <div class="tw-flex tw-items-center">
              @if (brandingFeatureConfig.illustrationsAllowed && !isExportInProgress && !exportableAccountingExportIds.length) {
                <app-svg-icon [styleClasses]="'tw-flex tw-mt-1-px tw-pr-8-px'" [svgSource]="'check'" [height]="'24px'" [width]="'24px'"></app-svg-icon>
              }
              @if (brandingFeatureConfig.illustrationsAllowed && ((!isExportInProgress && exportableAccountingExportIds.length) || (isExportInProgress))) {
                <app-svg-icon [styleClasses]="'tw-flex tw-mt-1-px tw-pr-8-px tw-text-icon-secondary'" [svgSource]="'arrow-tail-up'" [height]="'24px'" [width]="'24px'"></app-svg-icon>
              }
              @if (!isExportInProgress && !exportableAccountingExportIds.length && !accountingExportSummary) {
                <h3 [ngClass]="brandingStyle.dashboard.exportSectionHeaderText">{{ 'dashboard.exportHeaderFirstTimeZeroStateText' | transloco}}</h3>
              }
              @if (isExportInProgress) {
                <h3 [ngClass]="brandingStyle.dashboard.exportSectionHeaderText"> {{ ( appName === AppName.SAGE50 ? 'dashboardExportSection.exportingExpensesToAppSage50' : 'dashboardExportSection.exportingExpensesToApp' ) | transloco: { processedCount: processedCount, totalCount: exportableAccountingExportIds.length, appName: uiExposedAppName } }}</h3>
              }
              @if (!isExportInProgress && exportableAccountingExportIds.length) {
                <h3 [ngClass]="brandingStyle.dashboard.exportSectionHeaderText"> {{ 'dashboardExportSection.expensesReadyToExport' | transloco: { count: exportableAccountingExportIds.length } }}</h3>
              }
              @if (!isExportInProgress && !exportableAccountingExportIds.length && accountingExportSummary?.successful_accounting_export_count) {
                <h3 [ngClass]="brandingStyle.dashboard.exportSectionHeaderText">{{ (brandingConfig.brandId === 'co' && appName === AppName.QBD_DIRECT ? 'qbd_direct.dashboard.exportHeaderZeroStateText' : 'dashboard.exportHeaderZeroStateText') | transloco}}</h3>
              }
              @if (brandingConfig.brandId !== 'co') {
                <app-svg-icon [svgSource]="'info-circle-fill'" [width]="'16px'" [height]="'16px'" [styleClasses]="'tw-flex tw-text-info tw-ml-4-px tw-text-text-brand-primary'" [tooltipText]="'dashboardExportSection.exportTooltip' | transloco: { brandName: brandingConfig.brandName }" [tooltipPosition]="'top'"></app-svg-icon>
              }
            </div>
            @if (!isExportInProgress && !exportableAccountingExportIds.length && !accountingExportSummary && brandingFeatureConfig.featureFlags.contentVersion === 'v1') {
              <h5 [ngClass]="[brandingStyle.dashboard.exportSectionDescriptionText,brandingFeatureConfig.illustrationsAllowed ? 'tw-pl-34-px' : 'tw-pl-0']">
                {{ 'dashboardExportSection.noNewExpensesToExportV1Prefix' | transloco }}
                <p [ngClass]="brandingStyle.dashboard.exportSectionDescriptionSubText">
                  {{ 'dashboardExportSection.expensesAvailableHereForExport' | transloco: { importStates: importStates } }}
                </p>
              </h5>
            }
            @if (!isExportInProgress && !exportableAccountingExportIds.length && !accountingExportSummary && brandingFeatureConfig.featureFlags.contentVersion === 'v2') {
              <h5 [ngClass]="[brandingStyle.dashboard.exportSectionDescriptionText,brandingFeatureConfig.illustrationsAllowed ? 'tw-pl-34-px' : 'tw-pl-0']">
                <p [ngClass]="brandingStyle.dashboard.exportSectionDescriptionSubText">
                  {{ 'dashboardExportSection.expensesAvailableInDashboard' | transloco: { importStates: importStates } }}
                </p>
              </h5>
            }
            @if (isExportInProgress) {
              <h5 [ngClass]="[brandingStyle.dashboard.exportSectionDescriptionText,brandingFeatureConfig.illustrationsAllowed ? 'tw-pl-34-px' : 'tw-pl-0']">{{ 'dashboardExportSection.exportInProgressMessage' | transloco }}</h5>
            }
            @if (!isExportInProgress && !exportableAccountingExportIds.length && accountingExportSummary?.successful_accounting_export_count) {
              <h5 [ngClass]="[brandingStyle.dashboard.exportSectionDescriptionText,brandingFeatureConfig.illustrationsAllowed ? 'tw-pl-34-px' : 'tw-pl-0']">
                {{ (brandingConfig.brandId === 'co' && appName === AppName.QBD_DIRECT ? 'qbd_direct.dashboard.noExpensesToExport' : 'dashboardExportSection.noExpensesToExport') | transloco: { importStates: importStates } }}
              </h5>
            }
            @if (!isExportInProgress && failedExpenseGroupCount !== null && failedExpenseGroupCount > 0) {
              <div fxLayout="row" fxFlex="4" class="tw-flex" [ngClass]="[brandingStyle.dashboard.exportSectionDescriptionText,brandingFeatureConfig.illustrationsAllowed ? 'tw-pl-34-px' : 'tw-pl-0']">
                <h5>{{ 'dashboardExportSection.exportSummary' | transloco: { newCount: (exportableAccountingExportIds.length - failedExpenseGroupCount > 0 ? exportableAccountingExportIds.length - failedExpenseGroupCount : 0), failedCount: failedExpenseGroupCount } }}</h5>
              </div>
            }
            @if (!isExportInProgress && exportableAccountingExportIds.length && (failedExpenseGroupCount === null || failedExpenseGroupCount === 0)) {
              <div fxLayout="row" fxFlex="4" class="tw-flex" [ngClass]="[brandingStyle.dashboard.exportSectionDescriptionText,brandingFeatureConfig.illustrationsAllowed ? 'tw-pl-34-px' : 'tw-pl-0']">
                <h5>{{ 'dashboardExportSection.exportSummaryZeroFailed' | transloco: { newCount: exportableAccountingExportIds.length } }}</h5>
              </div>
            }
          </div>
          <div class="tw-flex tw-items-end tw-justify-end">
            <div class="tw-flex tw-justify-end tw-items-center">
              <app-button  [buttonSize]="ButtonSize.MEDIUM" [buttonType]="ButtonType.PRIMARY" (buttonClick)="triggerExport()" [disabled]="isExportButtonDisabled || isExportInProgress || !exportableAccountingExportIds.length" [svgSource]="'arrow-tail-right-medium'" [buttonText]="isExportInProgress ? ('dashboardExportSection.exportingButtonText' | transloco) : ('dashboardExportSection.exportButtonText' | transloco)"></app-button>
              <br>
              </div>
            </div>
          </div>
          @if (appName === AppName.QBD_DIRECT && isExportInProgress) {
            <div class="tw-pt-16-px">
              <app-configuration-info-label
                [infoText]="'dashboardExportSection.qbdInfoText' | transloco">
              </app-configuration-info-label>
            </div>
          }
        </div>
        @if (isExportInProgress) {
          <div >
            <p-progressBar class="!tw-h-6-px" [value]="exportProgressPercentage" [showValue]='false' [mode]="loaderType"></p-progressBar>
          </div>
        }
      </div>
    }

    <!-- Shimmers -->
    <div class="tw-shadow-app-card tw-rounded-8-px tw-bg-white tw-z-1 tw-relative">
      <app-shimmers [isDashboardImportInProgress]="isImportInProgress"></app-shimmers>
    </div>
  </div>
