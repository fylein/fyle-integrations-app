<p-dialog header="{{exportLogHeader}} Expenses" [dismissableMask]="true" [modal]="true" [draggable]="false" [(visible)]="isExportLogVisible" [position]="'top-right'" [style]="{ width: '50vw', height: '100vh' }">
    <div class="tw-rounded-6-px tw-bg-white tw-border-1-px">
        <p-table #dt2 [value]="accountingExports ? accountingExports : dummyExpenseGroupList">
            <ng-template pTemplate="header">
                <tr>
                    <th>Reference ID</th>
                    <th>Date and Time of Export</th>
                    <th>Employee Name and ID</th>
                    <th *ngIf="exportLogHeader==='Successful'">Exported As</th>
                    <th *ngIf="exportLogHeader==='Successful'">Link to Sage Intacct</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData>
                <tr *ngIf="!isExportLogFetchInProgress">
                    <td class="tw-underline tw-cursor-pointer" (click)="openUrl($event, rowData.fyleUrl)">{{rowData.referenceNumber}}</td>
                    <td>
                        <p class="tw-font-400 tw-text-sub-text-color">{{rowData.exportedAt | date}}</p>
                        <span class="tw-font-400 !tw-text-12-px tw-text-placeholder">{{rowData.exportedAt | date : "HH:ss"}}</span>
                    </td>
                    <td>
                        <h4 [ngClass]="{'truncate': rowData.employee[0]?.length > 16}"
                            [pTooltip]="rowData.employee[0]?.length > 16 ? rowData.employee[0] : null"
                            tooltipPosition="top">
                            {{rowData.employee[0]}}
                        </h4>
                        <h5 class="tw-font-400 !tw-text-12-px tw-text-placeholder"
                            [ngClass]="{'truncate': rowData.employee[1]?.length > 16}"
                            [pTooltip]="rowData.employee[1]?.length > 16 ? rowData.employee[1] : null"
                            tooltipPosition="top">
                            {{rowData.employee[1]}}
                        </h5>                    
                    </td>
                    <td *ngIf="exportLogHeader==='Successful'">{{rowData.exportedAs | snakeCaseToSpaceCase | titlecase}}</td>
                    <td *ngIf="exportLogHeader==='Successful'">
                        <div *ngIf="rowData.intacctUrl">
                          <button (click)="openUrl($event, rowData.intacctUrl)" pTooltip="Open in New Tab" tooltipPosition="top">
                            <svg-icon-sprite class="tw-pt-5-px" src="open-in-new-tab" width="20px" height="20px"></svg-icon-sprite>
                          </button>
                        </div>
                    </td>
                </tr>
                <ng-container *ngTemplateOutlet="shimmers"></ng-container>
            </ng-template>
        </p-table>
    </div>
</p-dialog>

<ng-template #shimmers>
    <tr *ngFor="let _ of [0,1,2,3,4,5,6]">
        <td *ngIf="isExportLogFetchInProgress"><p-skeleton width="50px" height="28px" shape="rectangle"></p-skeleton></td>
        <td *ngIf="isExportLogFetchInProgress"><p-skeleton width="100px" height="28px" shape="rectangle"></p-skeleton></td>
        <td *ngIf="isExportLogFetchInProgress"><p-skeleton width="100px" height="28px" shape="rectangle"></p-skeleton></td>
        <td *ngIf="isExportLogFetchInProgress && exportLogHeader==='Successful'"><p-skeleton width="50px" height="28px" shape="rectangle"></p-skeleton></td>
        <td *ngIf="isExportLogFetchInProgress && exportLogHeader==='Successful'"><p-skeleton width="50px" height="28px" shape="rectangle"></p-skeleton></td>
    </tr>
</ng-template>