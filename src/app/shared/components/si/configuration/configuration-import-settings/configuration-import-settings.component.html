<div *ngIf="isLoading" class="tw-flex tw-justify-center tw-items-center tw-h-screen">
    <app-loader></app-loader>
</div>
<div *ngIf="!isLoading" class="configuration--contents tw-border-separator tw-mt-6">
    <div>
        <app-configuration-step-header 
        [headerText]="'Import Settings'"
        [contentText]="'In this section, you can choose the fields required to be imported from Sage Intacct to Fyle.'"
        [redirectLink]="RedirectLink.INTACCT"
        [showSyncButton]="true"></app-configuration-step-header>
    </div>
    <form [formGroup]="importSettingsForm">
        <div class="tw-p-24-px">
            <div class="container">
                <div class="sub-text">
                  <h4 class="tw-text-16-px !tw-font-500 ">Import Sage Intacct Dimensions</h4>
                  <h5 class="!tw-text-faded-text-color tw-text-14-px tw-pt-10-px !tw-font-400 !tw-leading-4 tw-pb-4">The Sage Intacct dimensions listed below will be mapped to their corresponding Fyle Field as shown below. Importing these dimensions from Sage Intacct to Fyle will make the values available as a dropdown in the expense form for your employees to choose from. <a href="#" class="tw-text-hyperlink-color tw-cursor-pointer">Click here</a> to preview.</h5>
                  <div class="tw-pt-4 sub-text-note">
                    <svg-icon-sprite src="info" width="20px" hight="20px" class="tw-text-slightly-normal-text-color"></svg-icon-sprite>
                    This is a default mapping and you will not be able to modify it.
                  </div>
                </div>
              </div>
            </div>
            <div class="fields-header" fxLayout="row" fxLayoutAlign="start center">
                <div class="fields-header-text tw-pl-12 tw-pr-36">Sage Intacct Dimensions</div>
                <div class="fields-header-text tw-pl-32 tw-pr-36">Fyle Fields</div>
                <div class="fields-header-text tw-pl-36 tw-flex">
                    Import to Fyle
                    <svg-icon-sprite src="info" width="20px" hight="20px" class="tw-text-slightly-normal-text-color tw-pl-2"></svg-icon-sprite>
                </div>
            </div>
            <div class="tw-pt-18-px">
                <span class="tw-pl-12 tw-pr-6">
                    <input type="text" class="tw-text-14-px !tw-font-500 tw-w-300-px !tw-px-10-px !tw-py-8-px tw-border tw-border-solid !tw-border-separator tw-rounded-4-px" value="Account/Payment" disabled>
                </span>
                <span class="tw-pl-36 tw-pr-3">
                    <input type="text" class="tw-text-14-px !tw-font-500 tw-w-300-px !tw-px-10-px !tw-py-8-px tw-border tw-border-solid !tw-border-separator tw-rounded-4-px" value="Categories" disabled>
                </span>
                <span class="tw-pl-16 input-toggle-section">
                    <p-inputSwitch formControlName="importVendorAsMerchant"></p-inputSwitch>
                </span>
            </div>
            <div class="tw-pt-18-px">
                <span class="tw-pl-12 tw-pr-6">
                    <input type="text" class="tw-text-14-px !tw-font-500 tw-w-300-px !tw-px-10-px !tw-py-8-px tw-border tw-border-solid !tw-border-separator tw-rounded-4-px" value="Vendor" disabled>
                </span>
                <span class="tw-pl-36 tw-pr-3">
                    <input type="text" class="tw-text-14-px !tw-font-500 tw-w-300-px !tw-px-10-px !tw-py-8-px tw-border tw-border-solid !tw-border-separator tw-rounded-4-px" value="Merchant" disabled>
                </span>
                <span class="tw-pl-16 input-toggle-section">
                    <p-inputSwitch formControlName="importCategories"></p-inputSwitch>
                </span>
            </div>
            <div class="tw-pt-18-px">
                <span class="tw-pl-12 tw-pr-6">
                    <input type="text" class="tw-text-14-px !tw-font-500 tw-w-300-px !tw-px-10-px !tw-py-8-px tw-border tw-border-solid !tw-border-separator tw-rounded-4-px" value="Tax Detail" disabled>
                </span>
                <span class="tw-pl-36 tw-pr-3">
                    <input type="text" class="tw-text-14-px !tw-font-500 tw-w-300-px !tw-px-10-px !tw-py-8-px tw-border tw-border-solid !tw-border-separator tw-rounded-4-px" value="Tax Group" disabled>
                </span>
                <span class="tw-pl-16 input-toggle-section">
                    <p-inputSwitch formControlName="importTaxCodes"></p-inputSwitch>
                </span>
            </div>
            <div class="tw-pt-18-px tw-pl-12" *ngIf="importSettingsForm.value?.importTaxCodes">
                <p-dropdown [options]="sageIntacctTaxGroup" optionLabel="value" class="tw-w-600-px" formControlName="sageIntacctTaxCodes" placeholder="Select Tax Group">
                </p-dropdown>
            </div>
            <div class="tw-p-24-px">
                <div class="container">
                    <div class="sub-text">
                      <h4 class="tw-text-16-px !tw-font-500 ">Import / Map Sage Intacct Dimensions</h4>
                      <h5 class="!tw-text-faded-text-color tw-text-14-px tw-pt-10-px !tw-font-400 !tw-leading-4 tw-pb-4">The Sage Intacct dimensions listed below can be mapped to an existing Fyle field of your preference, or a new custom field. Importing these dimensions from Sage Intacct to Fyle will make the values available as a dropdown in the expense form for your employees to choose from.  <a href="#" class="tw-text-hyperlink-color tw-cursor-pointer">Click here</a> to preview.</h5>
                      <div class="tw-pt-4 sub-text-note">
                        <svg-icon-sprite src="info" width="20px" hight="20px" class="tw-text-slightly-normal-text-color"></svg-icon-sprite>
                        If you'd like to use only selective data from Sage Intacct, map a Sage Intacct dimension to a field in Fyle and turn off the import, as importing the data will sync in all the active values in Sage Intacct. You can add the required values in Fyle and map them later in the integration mapping section.
                      </div>
                    </div>
                  </div>
                  <div class="tw-p-24-px">
                    <div class="fields-header" fxLayout="row" fxLayoutAlign="start center">
                        <div class="fields-header-text tw-pr-36">Sage Intacct Dimensions</div>
                        <div class="fields-header-text tw-pl-32 tw-pr-32">Fyle Fields</div>
                        <div class="fields-header-text tw-pl-36 tw-flex">
                            Import to Fyle
                            <svg-icon-sprite src="info" width="20px" hight="20px" class="tw-text-slightly-normal-text-color tw-pl-2"></svg-icon-sprite>
                        </div>
                    </div>
                    <div class="tw-pt-18-px">
                        <span class="tw-pr-6">
                            <p-dropdown [options]="sageIntacctFields" optionLabel="display_name" class="tw-w-600-px" formControlName="importVendorAsMerchant" [placeholder]="'Select Sage Intacct Field'">
                            </p-dropdown>
                        </span>
                        <span class="tw-pl-36 tw-pr-3">
                            <p-dropdown [options]="fyleFields" optionLabel="display_name" class="tw-w-600-px" formControlName="importVendorAsMerchant" [placeholder]="'Select Fyle Expense Field'">
                            </p-dropdown>
                        </span>
                        <span class="tw-pl-16 input-toggle-section">
                            <p-inputSwitch formControlName="importVendorAsMerchant"></p-inputSwitch>
                        </span>
                    </div>
                    <div class="tw-pt-18-px">
                        <span class="tw-pr-6">
                            <p-dropdown [options]="sageIntacctFields" optionLabel="display_name" class="tw-w-600-px" formControlName="importVendorAsMerchant" [placeholder]="'Select Sage Intacct Field'">
                            </p-dropdown>
                        </span>
                        <span class="tw-pl-36 tw-pr-3">
                            <p-dropdown [options]="fyleFields" optionLabel="display_name" class="tw-w-600-px" formControlName="importVendorAsMerchant" [placeholder]="'Select Fyle Expense Field'">
                            </p-dropdown>
                        </span>
                        <span class="tw-pl-16 input-toggle-section">
                            <p-inputSwitch formControlName="importVendorAsMerchant"></p-inputSwitch>
                        </span>
                    </div>
                    <div class="tw-pt-18-px">
                        <span class="tw-pr-6">
                            <p-dropdown [options]="sageIntacctFields" optionLabel="display_name" class="tw-w-600-px" formControlName="importVendorAsMerchant" [placeholder]="'Select Sage Intacct Field'">
                            </p-dropdown>
                        </span>
                        <span class="tw-pl-36 tw-pr-3">
                            <p-dropdown [options]="fyleFields" optionLabel="display_name" class="tw-w-600-px" formControlName="importVendorAsMerchant" [placeholder]="'Select Fyle Expense Field'">
                            </p-dropdown>
                        </span>
                        <span class="tw-pl-16 input-toggle-section">
                            <p-inputSwitch formControlName="importVendorAsMerchant"></p-inputSwitch>
                        </span>
                    </div>



                    <div class="row" *ngFor="let expenseField of expenseFieldsGetter.controls; let i = index" [formGroupName]="i">
                        <div class="p-d-flex p-ai-center">

                            <p-dropdown [options]="sageIntacctFields" placeholder="Choose Sage Intacct field" formControlName="destination_field"
                                optionLabel="display_name" optionValue="attribute_type" class="p-mr-2" style="width:38%"></p-dropdown>


                            <p-dropdown [options]="fyleFields" [placeholder]="'Choose Fyle Expense field'" formControlName="source_field"
                                optionLabel="display_name" optionValue="attribute_type" class="p-mr-2" style="width:38%">
                                <ng-template pTemplate="item" let-item>
                                    <div>
                                        {{ item.display_name | titlecase }}
                                    </div>
                                </ng-template>
                            </p-dropdown>

                            <!-- <div *ngIf="i !== 0 && expenseField.controls.destination_field.status !== 'DISABLED'" style="flex: 5%;">
                                <button pButton icon="pi pi-trash" class="p-button-rounded p-button-danger" (click)="removeExpenseField(i, expenseField.controls.source_field.value)"></button>
                            </div>
                            <div *ngIf="!(i !== 0 && expenseField.controls.destination_field.status !== 'DISABLED')" style="flex: 5%;"></div> -->

                            <p-slideToggle formControlName="import_to_fyle" style="flex: 14%;" class="toggle"></p-slideToggle>
                        </div>

                        <div class="expense-fields--errors" style="color: warning;" *ngIf="expenseField.status === 'INVALID' && expenseField.value.source_field && expenseField.value.destination_field">
                            Fyle and Sage Intacct fields should be unique
                        </div>
                    </div>





                  </div>
                </div>
            <div>
            <app-configuration-step-footer [ctaText] = "!saveInProgress ? (isOnboarding ? ConfigurationCtaText.SAVE_AND_CONTINUE : ConfigurationCtaText.SAVE) : ConfigurationCtaText.SAVING" (save)="null" [isButtonDisabled]="true"></app-configuration-step-footer>
        </div>
    </form>
</div>